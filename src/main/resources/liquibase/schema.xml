<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<changeSet id="1" author="kubernetes" dbms="h2,mysql">
		<createTable tableName="user_account">
			<column name="USER_ACCOUNT_PK" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="CUSTOMER_TYPE_FK" type="BIGINT" />
			<column name="USER_NAME" type="VARCHAR(100)"></column>
		</createTable>
		<createTable tableName="shipment">
			<column name="SHIPMENT_PK" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="FROM_ADDRESS" type="VARCHAR(500)"></column>
			<column name="TO_ADDRESS" type="VARCHAR(500)"></column>
			<column name="USER_ACCOUNT_FK" type="BIGINT"></column>
			<column name="COST_FK" type="BIGINT"></column>
			<column name="SHIPMENT_ORGANIZATION_FK" type="BIGINT"></column>
		</createTable>
		<createTable tableName="cost">
			<column name="COST_PK" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="DELIVERY_TIME" type="VARCHAR(100)"></column>
			<column name="DELIVERY_COST" type="BIGINT"></column>
			<column name="PRODUCT_WEIGHT_FK" type="BIGINT"></column>
			<column name="FREIGHT_FK" type="BIGINT"></column>
			<column name="WEIGHTAGE_FK" type="BIGINT"></column>
		</createTable>
		<createTable tableName="product_weight">
			<column name="PRODUCT_WEIGHT_PK" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="PRODUCT_MIN_WEIGHT" type="BIGINT"></column>
			<column name="PRODUCT_MAX_WEIGHT" type="BIGINT"></column>
		</createTable>
		<createTable tableName="freight_customer">
			<column name="FREIGHT_CUSTOMER_PK" type="BIGINT"
				autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="FREIGHT_FK" type="BIGINT"></column>
			<column name="CUSTOMER_FK" type="BIGINT"></column>
			<column name="ORGANIZATION_FK" type="BIGINT"></column>
		</createTable>

		<createTable tableName="customer_type">
			<column name="CUSTOMER_TYPE_PK" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="CUSTOMER_TYPE_NAME" type="VARCHAR(100)"></column>
		</createTable>

		<createTable tableName="weightage">
			<column name="WEIGHTAGE_PK" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="TIME_FEEDBACK" type="BIGINT"></column>
			<column name="DELIVERY_FEEDBACK" type="BIGINT"></column>
			<column name="TOTAL_TIME_FEEDBACK" type="BIGINT"></column>
			<column name="TOTAL_DELIBERY_FEEDBACK" type="BIGINT"></column>
		</createTable>

		<createTable tableName="freight_management">
			<column name="FREIGHT_MANAGEMENT_PK" type="BIGINT"
				autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="FREIGHT_NAME" type="VARCHAR(100)"></column>
		</createTable>
		<createTable tableName="organization">
			<column name="ORGANIZATION_PK" type="BIGINT" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="ORGANIZATION_NAME" type="VARCHAR(100)"></column>
		</createTable>

		<addForeignKeyConstraint constraintName="COST_WEIGHT"
			referencedTableName="weightage" baseColumnNames="WEIGHTAGE_FK"
			baseTableName="cost" referencedColumnNames="WEIGHTAGE_PK" />
		
		<addForeignKeyConstraint constraintName="USER_CUSTOMER_TYPE"
			referencedTableName="customer_type" baseColumnNames="CUSTOMER_TYPE_FK"
			baseTableName="user_account" referencedColumnNames="CUSTOMER_TYPE_PK" />

		<addForeignKeyConstraint constraintName="SHIPMENT_ORGANIZATION"
			referencedTableName="organization" baseColumnNames="SHIPMENT_ORGANIZATION_FK"
			baseTableName="shipment" referencedColumnNames="ORGANIZATION_PK" />

		<addForeignKeyConstraint constraintName="ORGANIZATION_FREIGHT_CUSTOMER"
			referencedTableName="organization" baseColumnNames="ORGANIZATION_FK"
			baseTableName="freight_customer" referencedColumnNames="ORGANIZATION_PK" />

		<addForeignKeyConstraint constraintName="FREIGHT_CUSTOMER_CONSTRAINT"
			referencedTableName="customer_type" baseColumnNames="CUSTOMER_FK"
			baseTableName="freight_customer" referencedColumnNames="CUSTOMER_TYPE_PK" />

		<addForeignKeyConstraint constraintName="FREIGHT_CUSTOMER_TYPE"
			referencedTableName="freight_management" baseColumnNames="FREIGHT_FK"
			baseTableName="freight_customer" referencedColumnNames="FREIGHT_MANAGEMENT_PK" />

		<addForeignKeyConstraint constraintName="USER_SHIPMENT"
			referencedTableName="user_account" baseColumnNames="USER_ACCOUNT_FK"
			baseTableName="shipment" referencedColumnNames="USER_ACCOUNT_PK" />
		<addForeignKeyConstraint constraintName="WEIGHT_COST"
			referencedTableName="product_weight" baseColumnNames="PRODUCT_WEIGHT_FK"
			baseTableName="cost" referencedColumnNames="PRODUCT_WEIGHT_PK" />
		
		<addForeignKeyConstraint constraintName="COST_FREIGHT_CUSTOMER_TYPE"
			referencedTableName="freight_customer" baseColumnNames="FREIGHT_FK"
			baseTableName="cost" referencedColumnNames="FREIGHT_FK" />
	</changeSet>
</databaseChangeLog>